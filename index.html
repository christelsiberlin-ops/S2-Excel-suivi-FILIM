<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi Formation Excel - GEA S1</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      // ‚öôÔ∏è CONFIGURATION - Remplacez par l'URL de votre Web App Google Apps Script
      const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbzhf_hODrQWcON7gINuGqQIeiy_Ga50Lpp1eP97SjfGKQjBHPpooAKhIr7qJ6NfG9L8/exec';

      const App = () => {
        const [progress, setProgress] = useState({});
        const [currentView, setCurrentView] = useState('home');
        const [selectedStudent, setSelectedStudent] = useState(null);
        const [loading, setLoading] = useState(false);
        const [syncStatus, setSyncStatus] = useState('');
        const [isConfigured, setIsConfigured] = useState(false);
        const [showImportModal, setShowImportModal] = useState(false);
        const [students, setStudents] = useState([
          { id: 1, nom: "Riyad ABKARI", groupe: "TD1" },
          { id: 2, nom: "Adel ALAHYANE", groupe: "TD1" },
          { id: 3, nom: "Tahsan Bin BADAR", groupe: "TD2" },
          { id: 4, nom: "Albin BARTH", groupe: "TD1" },
          { id: 5, nom: "Johannie BEAUCHAMP", groupe: "TD1" },
          { id: 6, nom: "Ibrahim BELKAID", groupe: "TD2" },
          { id: 7, nom: "Mohamed BENMEHAL", groupe: "TD1" },
          { id: 8, nom: "Adam BERTRAND", groupe: "TD2" },
          { id: 9, nom: "Timoth√© BESSON", groupe: "TD1" },
          { id: 10, nom: "Moses BITA", groupe: "TD2" },
          { id: 11, nom: "F√©riel BOUDJEMAI", groupe: "TD2" },
          { id: 12, nom: "Titouan BOULAU", groupe: "TD1" },
          { id: 13, nom: "Lyna-Tounsia BOUSFOUL", groupe: "TD2" },
          { id: 14, nom: "Thibaut CADOT", groupe: "TD2" },
          { id: 15, nom: "Ambre CAILLAUD", groupe: "TD2" },
          { id: 16, nom: "Guilhem CASSOU", groupe: "TD2" },
          { id: 17, nom: "Myriam CHAIR", groupe: "TD2" },
          { id: 18, nom: "Alexandre CHASSAING", groupe: "TD2" },
          { id: 19, nom: "Philom√®ne CONSTANS", groupe: "TD1" },
          { id: 20, nom: "Enzo CORREIA TE", groupe: "TD1" },
          { id: 21, nom: "Njock-M√©lissa DANG ATIOCK", groupe: "TD1" },
          { id: 22, nom: "Gabriel DE LA FAYOLLE DE MARS", groupe: "TD1" },
          { id: 23, nom: "C√©dric DIABI", groupe: "TD2" },
          { id: 24, nom: "Sofiane DKAKI", groupe: "TD1" },
          { id: 25, nom: "Valentin DOMBRAY", groupe: "TD1" },
          { id: 26, nom: "Gabriel DUPUY", groupe: "TD2" },
          { id: 27, nom: "Marwa EL AATTAR", groupe: "TD1" },
          { id: 28, nom: "Thibaud √âTOURNEAU", groupe: "TD1" },
          { id: 29, nom: "Lucas FERBOURS", groupe: "TD1" },
          { id: 30, nom: "Mathis FERNANDES-CLAVERIE", groupe: "TD1" },
          { id: 31, nom: "Mathieu FEROLDI", groupe: "TD2" },
          { id: 32, nom: "Raphael FERT", groupe: "TD2" },
          { id: 33, nom: "Audrey GEYMET", groupe: "TD2" },
          { id: 34, nom: "Priyanga GNANARAJ", groupe: "TD2" },
          { id: 35, nom: "Rapha√´l GROSJEAN", groupe: "TD2" },
          { id: 36, nom: "Timoth√©e HUREL", groupe: "TD2" },
          { id: 37, nom: "Dany KEBAILI", groupe: "TD2" },
          { id: 38, nom: "Luc Rigson KENDINE BOUONGNON", groupe: "TD2" },
          { id: 39, nom: "Hadi KLEIT", groupe: "TD2" },
          { id: 40, nom: "Nitsa KOURILSKY", groupe: "TD2" },
          { id: 41, nom: "Gianni LANZARONE", groupe: "TD2" },
          { id: 42, nom: "Davidson LAPOINTE", groupe: "TD1" },
          { id: 43, nom: "Gabrielle LEROUXEL", groupe: "TD1" },
          { id: 44, nom: "Melvyn LUREL", groupe: "TD1" },
          { id: 45, nom: "Clo√© MEYER", groupe: "TD1" },
          { id: 46, nom: "Lokmene OULHOUSSAINE", groupe: "TD2" },
          { id: 47, nom: "Maud OUSSET", groupe: "TD1" },
          { id: 48, nom: "Victor POMMIES", groupe: "TD1" },
          { id: 49, nom: "Romain PUPIN", groupe: "TD2" },
          { id: 50, nom: "Alexandru PURCSA", groupe: "TD1" },
          { id: 51, nom: "Husna SAKAL", groupe: "TD1" },
          { id: 52, nom: "Pierre TARDIVEL", groupe: "TD1" },
          { id: 53, nom: "Anna TELLIER", groupe: "TD1" },
          { id: 54, nom: "Amadou THIOYE", groupe: "TD2" },
          { id: 55, nom: "Mathis VOISENET", groupe: "TD1" },
          { id: 56, nom: "Victor WATTEBLED", groupe: "TD2" },
          { id: 57, nom: "Antoine WEGERA--BESSON", groupe: "TD1" }
        ]);

        // V√©rifier la configuration au d√©marrage
        useEffect(() => {
          setIsConfigured(GOOGLE_SHEETS_URL !== 'VOTRE_URL_WEB_APP_ICI');
        }, []);

        // Charger les donn√©es depuis Google Sheets au d√©marrage
        useEffect(() => {
          if (isConfigured) {
            loadAllProgress();
          }
        }, [isConfigured]);

        // Fonction pour charger toutes les progressions depuis Google Sheets
        const loadAllProgress = async () => {
          if (!isConfigured) return;
          
          setLoading(true);
          try {
            const response = await fetch(`${GOOGLE_SHEETS_URL}?action=getAll`);
            const data = await response.json();
            
            if (data.success) {
              setProgress(data.data || {});
              setSyncStatus('‚úÖ Donn√©es synchronis√©es');
            } else {
              setSyncStatus('‚ö†Ô∏è Erreur de chargement');
            }
          } catch (error) {
            console.error('Erreur de chargement:', error);
            setSyncStatus('‚ùå Erreur de connexion');
          } finally {
            setLoading(false);
            setTimeout(() => setSyncStatus(''), 3000);
          }
        };

        // Fonction pour sauvegarder la progression d'un √©tudiant
        const saveStudentProgress = async (studentName, progressData) => {
          if (!isConfigured) return;
          
          try {
            const response = await fetch(GOOGLE_SHEETS_URL, {
              method: 'POST',
              mode: 'no-cors',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                action: 'save',
                student: studentName,
                progress: progressData
              })
            });
            
            setSyncStatus('‚úÖ Sauvegarde r√©ussie');
            setTimeout(() => setSyncStatus(''), 2000);
          } catch (error) {
            console.error('Erreur de sauvegarde:', error);
            setSyncStatus('‚ùå Erreur de sauvegarde');
            setTimeout(() => setSyncStatus(''), 3000);
          }
        };

        // Fonction pour importer des √©tudiants depuis un CSV
        const handleImportCSV = (file) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const text = e.target.result;
            // Utiliser un parser simple
            const lines = text.split('\n').filter(line => line.trim());
            const newStudents = [];
            
            // D√©tecter si la premi√®re ligne est un header
            const firstLine = lines[0].toLowerCase();
            const hasHeader = firstLine.includes('nom') || firstLine.includes('prenom') || firstLine.includes('groupe');
            const startIndex = hasHeader ? 1 : 0;
            
            for (let i = startIndex; i < lines.length; i++) {
              const line = lines[i].trim();
              if (!line) continue;
              
              // S√©parer par virgule ou point-virgule
              const parts = line.split(/[,;]/).map(p => p.trim());
              if (parts.length >= 2) {
                newStudents.push({
                  id: i - startIndex + 1,
                  nom: parts[0],
                  groupe: parts[1]
                });
              }
            }
            
            if (newStudents.length > 0) {
              setStudents(newStudents);
              setSyncStatus(`‚úÖ ${newStudents.length} √©tudiants import√©s`);
              setShowImportModal(false);
              setTimeout(() => setSyncStatus(''), 3000);
            } else {
              setSyncStatus('‚ùå Aucun √©tudiant trouv√© dans le fichier');
              setTimeout(() => setSyncStatus(''), 3000);
            }
          };
          reader.readAsText(file);
        };

        const courseStructure = {
          niveau1: {
            title: "Niveau 1 - Basique",
            playlistCours: "https://www.youtube.com/playlist?list=PLoolrb8qXoJgAHld6i8spYcoSSc9InMLf",
            playlistExercices: "https://www.youtube.com/playlist?list=PLoolrb8qXoJggYYlRQw46oCrnJ6WZywm3",
            videos: [
              { id: 'n1v1', title: "Saisie et mise en forme", url: "https://www.youtube.com/watch?v=VF2uSP1CFMQ", quiz: "quiz-n1-v1.html" },
              { id: 'n1v2', title: "Faire des op√©rations", url: "https://www.youtube.com/watch?v=bunj6g_5zew", quiz: "quiz-n1-v2.html" },
              { id: 'n1v3', title: "Graphique simple - histogramme", url: "https://www.youtube.com/watch?v=JNl-H6VRz6U", quiz: "quiz-n1-v3.html" },
              { id: 'n1v4', title: "Graphique simple - courbe", url: "https://www.youtube.com/watch?v=P7z_Ub0Sr24", quiz: "quiz-n1-v4.html" },
              { id: 'n1v5', title: "Graphique simple - secteur", url: "https://www.youtube.com/watch?v=vuULoub8b5w", quiz: "quiz-n1-v5.html" },
              { id: 'n1v6', title: "Introduction aux bases de donn√©es", url: "https://www.youtube.com/watch?v=7262YgH3lZM", quiz: "quiz-n1-v6.html" },
              { id: 'n1v7', title: "Trier des donn√©es", url: "https://www.youtube.com/watch?v=OIBGHk1Hykk", quiz: "quiz-n1-v7.html" },
              { id: 'n1v8', title: "Filtrer les donn√©es", url: "https://www.youtube.com/watch?v=vrTRwHKIfXo", quiz: "quiz-n1-v8.html" },
              { id: 'n1v9', title: "Actions sur les feuilles", url: "https://www.youtube.com/watch?v=ngSww2uRsg8", quiz: "quiz-n1-v9.html" }
            ],
            exercices: [
              { id: 'n1e1', title: "Planning des gardes", url: "https://www.youtube.com/watch?v=zlXZqTwwdyI" },
              { id: 'n1e2', title: "Mise en forme et calculs", url: "https://www.youtube.com/watch?v=Vz1nef5QOjQ" }
            ]
          },
          niveau2: {
            title: "Niveau 2 - Op√©rationnel",
            playlistCours: "https://www.youtube.com/playlist?list=PLoolrb8qXoJhKqF7NNJrXCbJ2pJsbZrcz",
            playlistExercices: "https://www.youtube.com/playlist?list=PLoolrb8qXoJiM32J7GsAI6hOKqkpcV7JH",
            videos: [
              { id: 'n2v1', title: "Mise en forme conditionnelle simple", url: "https://www.youtube.com/watch?v=fE6ZIztg3Rc", quiz: "quiz-n2-v1.html" },
              { id: 'n2v2', title: "Calculs avec une r√©f√©rence absolue", url: "https://www.youtube.com/watch?v=HJ8TZ6IjLkM", quiz: "quiz-n2-v2.html" },
              { id: 'n2v3', title: "Calculs de pourcentage", url: "https://www.youtube.com/watch?v=0t4tG8Mc_rE", quiz: "quiz-n2-v3.html" },
              { id: 'n2v4', title: "Calculs de date", url: "https://www.youtube.com/watch?v=GVtzbem50ZM", quiz: "quiz-n2-v4.html" },
              { id: 'n2v5', title: "Calculs et conversion d'heure", url: "https://www.youtube.com/watch?v=iyLCFHeUjZs", quiz: "quiz-n2-v5.html" },
              { id: 'n2v6', title: "Assistant de formule", url: "https://www.youtube.com/watch?v=AeIIy9dkaqE", quiz: "quiz-n2-v6.html" },
              { id: 'n2v7', title: "Fonctions faciles", url: "https://www.youtube.com/watch?v=eYotxDT7ziM", quiz: "quiz-n2-v7.html" },
              { id: 'n2v8', title: "Fonction logique SI", url: "https://www.youtube.com/watch?v=nliQs3EOn2g", quiz: "quiz-n2-v8.html" },
              { id: 'n2v9', title: "Fonctions logiques ET & OU", url: "https://www.youtube.com/watch?v=UvqPVgZn8QI", quiz: "quiz-n2-v9.html" },
              { id: 'n2v10', title: "Valeur Cible", url: "https://www.youtube.com/watch?v=KaR5lsLsT0c", quiz: "quiz-n2-v10.html" },
              { id: 'n2v11', title: "Graphique barre", url: "https://www.youtube.com/watch?v=M_PIT_AeeZc", quiz: "quiz-n2-v11.html" },
              { id: 'n2v12', title: "Fonctions NbSi et SommeSi", url: "https://www.youtube.com/watch?v=FzXeDHhDvjI", quiz: "quiz-n2-v12.html" },
              { id: 'n2v13', title: "Groupe de travail", url: "https://www.youtube.com/watch?v=XWnwjkk_ot8", quiz: "quiz-n2-v13.html" },
              { id: 'n2v14', title: "Cellules et plages nomm√©es", url: "https://www.youtube.com/watch?v=JgmGXncp-Hk", quiz: "quiz-n2-v14.html" },
              { id: 'n2v15', title: "Le mode tableau 1", url: "https://www.youtube.com/watch?v=p9vqLbPW3RQ", quiz: "quiz-n2-v15.html" },
              { id: 'n2v16', title: "Le mode tableau 2", url: "https://www.youtube.com/watch?v=acEvNyJ1ydU", quiz: "quiz-n2-v16.html" }
            ],
            exercices: [
              { id: 'n2e1', title: "R√©visions BDD et fonctions", url: "https://www.youtube.com/watch?v=cayeg4b-VBQ" },
              { id: 'n2e2', title: "R√©visions Petit navire", url: "https://www.youtube.com/watch?v=Dx087Raj9r0" }
            ]
          },
          niveau3: {
            title: "Niveau 3 - Avanc√©",
            bonus: true,
            playlistCours: "https://www.youtube.com/playlist?list=PLoolrb8qXoJgFdctBDiX81_AnrGVOd-qL",
            playlistExercices: "https://www.youtube.com/playlist?list=PLoolrb8qXoJglLeM21MR2vWINY6UBx3SZ",
            videos: [
              { id: 'n3v1', title: "Format de cellule n¬∞2", url: "https://www.youtube.com/watch?v=oz35P_Xpat0", quiz: "quiz/niveau3/quiz-n3-v1.html" },
              { id: 'n3v2', title: "Validation de donn√©es", url: "https://www.youtube.com/watch?v=d7itfuv8gug", quiz: "quiz/niveau3/quiz-n3-v2.html" },
              { id: 'n3v3', title: "Fonction Date AUJOURDHUI", url: "https://www.youtube.com/watch?v=RU0VvyQBeEM", quiz: "quiz/niveau3/quiz-n3-v3.html" },
              { id: 'n3v4', title: "Fonctions Date JOUR MOIS ANNEE DATE", url: "https://www.youtube.com/watch?v=ewA6AQkxQ7U", quiz: "quiz/niveau3/quiz-n3-v4.html" },
              { id: 'n3v5', title: "Fonction Date MOIS.DECALER", url: "https://www.youtube.com/watch?v=2TrgKO1EqyY", quiz: "quiz/niveau3/quiz-n3-v5.html" },
              { id: 'n3v6', title: "Fonction Date JOURSEM", url: "https://www.youtube.com/watch?v=FnDOZyLVQok", quiz: "quiz/niveau3/quiz-n3-v6.html" },
              { id: 'n3v7', title: "Fonctions Texte CONCATENER MAJUSCULE MINUSCULE", url: "https://www.youtube.com/watch?v=JRyyM7jIDxc", quiz: "quiz/niveau3/quiz-n3-v7.html" },
              { id: 'n3v8', title: "Fonctions Texte GAUCHE DROITE STXT", url: "https://www.youtube.com/watch?v=5L0VmTOTfo8", quiz: "quiz/niveau3/quiz-n3-v8.html" },
              { id: 'n3v9', title: "SI ET OU et Imbrication", url: "https://www.youtube.com/watch?v=Gu1vTwWtyVU", quiz: "quiz/niveau3/quiz-n3-v9.html" },
              { id: 'n3v10', title: "Fonctions statistiques Grande valeur, Petite valeur & Rang", url: "https://www.youtube.com/watch?v=ifqem-tMxdg", quiz: "quiz/niveau3/quiz-n3-v10.html" },
              { id: 'n3v11', title: "RechercheV valeur exacte", url: "https://www.youtube.com/watch?v=4UBSrZrm6LI", quiz: "quiz/niveau3/quiz-n3-v11.html" },
              { id: 'n3v12', title: "Valeur exacte probl√©matiques courantes", url: "https://www.youtube.com/watch?v=QPgpO-Vtmto", quiz: "quiz/niveau3/quiz-n3-v12.html" },
              { id: 'n3v13', title: "RechercheV valeur proche", url: "https://www.youtube.com/watch?v=onR9v1aBm3s", quiz: "quiz/niveau3/quiz-n3-v13.html" },
              { id: 'n3v14', title: "Fonctions base de donn√©es", url: "https://www.youtube.com/watch?v=QWBhfQW1_3M", quiz: "quiz/niveau3/quiz-n3-v14.html" },
              { id: 'n3v15', title: "Fonctions INDEX & EQUIV", url: "https://www.youtube.com/watch?v=tdj8_HsZ9jU", quiz: "quiz/niveau3/quiz-n3-v15.html" },
              { id: 'n3v16', title: "Fonction SOMMEPROD", url: "https://www.youtube.com/watch?v=KEFWHz3TjLc", quiz: "quiz/niveau3/quiz-n3-v16.html" },
              { id: 'n3v17', title: "Graphique anneau", url: "https://www.youtube.com/watch?v=YHRLa5eHMkU", quiz: "quiz/niveau3/quiz-n3-v17.html" },
              { id: 'n3v18', title: "Graphique radar", url: "https://www.youtube.com/watch?v=y9BvSGvIo8U", quiz: "quiz/niveau3/quiz-n3-v18.html" },
              { id: 'n3v19', title: "Graphique Nuage de points", url: "https://www.youtube.com/watch?v=fV3wNQ-ANLc", quiz: "quiz/niveau3/quiz-n3-v19.html" },
              { id: 'n3v20', title: "Graphique courbe avanc√©", url: "https://www.youtube.com/watch?v=wt3T7QpMRp4", quiz: "quiz/niveau3/quiz-n3-v20.html" },
              { id: 'n3v21', title: "Graphique mixte", url: "https://www.youtube.com/watch?v=hV9C7-LvSlg", quiz: "quiz/niveau3/quiz-n3-v21.html" },
              { id: 'n3v22', title: "Cr√©ation manuelle de graphiques", url: "https://www.youtube.com/watch?v=On3G-hIiYpA", quiz: "quiz/niveau3/quiz-n3-v22.html" }
            ],
            exercices: [
              { id: 'n3e1', title: "Exercice pratique niveau 3 - Partie 1", url: "#" },
              { id: 'n3e2', title: "Exercice pratique niveau 3 - Partie 2", url: "#" }
            ]
          }
        };

        const seancePlanning = [
          { numero: 1, contenu: "Niveau 1 - Vid√©os 1-2", duree: "1h50" },
          { numero: 2, contenu: "Niveau 1 - Vid√©os 3-5", duree: "1h50" },
          { numero: 3, contenu: "Niveau 1 - Vid√©os 6-9 + Exercices", duree: "1h50" },
          { numero: 4, contenu: "√âVALUATION 1", duree: "1h50", evaluation: true },
          { numero: 5, contenu: "Niveau 2 - Vid√©os 1-4", duree: "1h50" },
          { numero: 6, contenu: "Niveau 2 - Vid√©os 5-9", duree: "1h50" },
          { numero: 7, contenu: "Niveau 2 - Vid√©os 10-16 + Exercices", duree: "1h50" },
          { numero: 8, contenu: "R√©visions et Niveau 3 (bonus)", duree: "1h50" },
          { numero: 9, contenu: "√âVALUATION 2", duree: "1h50", evaluation: true }
        ];

        const getStudentProgress = (studentName) => {
          return progress[studentName] || {
            niveau1: { videos: {}, exercices: {}, quizScores: {} },
            niveau2: { videos: {}, exercices: {}, quizScores: {} },
            niveau3: { videos: {}, exercices: {}, quizScores: {} }
          };
        };

        const updateProgress = (studentName, niveau, type, id, checked) => {
          const studentProgress = getStudentProgress(studentName);
          const updatedProgress = {
            ...studentProgress,
            [niveau]: {
              ...studentProgress[niveau],
              [type]: {
                ...studentProgress[niveau][type],
                [id]: checked
              }
            }
          };
          
          setProgress(prev => ({
            ...prev,
            [studentName]: updatedProgress
          }));
          
          // Sauvegarder dans Google Sheets
          saveStudentProgress(studentName, updatedProgress);
        };

        const updateQuizScore = (studentName, niveau, videoId, score) => {
          const studentProgress = getStudentProgress(studentName);
          const updatedProgress = {
            ...studentProgress,
            [niveau]: {
              ...studentProgress[niveau],
              quizScores: {
                ...studentProgress[niveau].quizScores,
                [videoId]: score
              }
            }
          };
          
          setProgress(prev => ({
            ...prev,
            [studentName]: updatedProgress
          }));
          
          // Sauvegarder dans Google Sheets
          saveStudentProgress(studentName, updatedProgress);
        };

        const calculateProgress = (studentProgress) => {
          let completed = 0;
          let total = 0;

          ['niveau1', 'niveau2', 'niveau3'].forEach(niveau => {
            const niveauData = courseStructure[niveau];
            niveauData.videos.forEach(v => {
              total++;
              if (studentProgress[niveau]?.videos?.[v.id]) completed++;
            });
            niveauData.exercices.forEach(e => {
              total++;
              if (studentProgress[niveau]?.exercices?.[e.id]) completed++;
            });
          });

          return total > 0 ? Math.round((completed / total) * 100) : 0;
        };

        const ConfigBanner = () => {
          if (isConfigured) return null;
          
          return (
            <div className="bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-4">
              <div className="flex">
                <div className="flex-shrink-0">
                  <svg className="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fillRule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                  </svg>
                </div>
                <div className="ml-3">
                  <p className="text-sm text-yellow-700">
                    <strong>‚öôÔ∏è Configuration requise :</strong> Veuillez configurer l'URL de votre Google Apps Script pour activer la synchronisation avec Google Sheets.
                  </p>
                </div>
              </div>
            </div>
          );
        };

        const ImportModal = ({ onClose, onImport }) => {
          const [file, setFile] = useState(null);
          const [preview, setPreview] = useState([]);

          const handleFileChange = (e) => {
            const selectedFile = e.target.files[0];
            if (selectedFile) {
              setFile(selectedFile);
              // Pr√©visualiser le fichier
              const reader = new FileReader();
              reader.onload = (event) => {
                const text = event.target.result;
                const lines = text.split('\n').slice(0, 6); // Premi√®re 5 lignes
                setPreview(lines);
              };
              reader.readAsText(selectedFile);
            }
          };

          return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
              <div className="bg-white rounded-lg p-6 max-w-2xl w-full mx-4">
                <h2 className="text-2xl font-bold text-gray-800 mb-4">
                  üì• Importer une liste d'√©tudiants
                </h2>
                
                <div className="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                  <p className="text-sm text-blue-800 mb-2">
                    <strong>Format attendu :</strong> Fichier CSV avec 2 colonnes s√©par√©es par une virgule ou point-virgule
                  </p>
                  <pre className="text-xs bg-white p-2 rounded border border-blue-200">
nom,groupe{'\n'}Jean DUPONT,TD1{'\n'}Marie MARTIN,TD2{'\n'}Pierre DURAND,TD1
                  </pre>
                </div>

                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    S√©lectionner un fichier CSV
                  </label>
                  <input
                    type="file"
                    accept=".csv,.txt"
                    onChange={handleFileChange}
                    className="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  />
                </div>

                {preview.length > 0 && (
                  <div className="mb-4">
                    <h3 className="text-sm font-medium text-gray-700 mb-2">Aper√ßu :</h3>
                    <div className="bg-gray-50 p-3 rounded border border-gray-200">
                      {preview.map((line, i) => (
                        <div key={i} className="text-xs text-gray-700 font-mono">
                          {line || '(ligne vide)'}
                        </div>
                      ))}
                      {preview.length >= 6 && <div className="text-xs text-gray-500 mt-1">...</div>}
                    </div>
                  </div>
                )}

                <div className="flex justify-end gap-3">
                  <button
                    onClick={onClose}
                    className="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"
                  >
                    Annuler
                  </button>
                  <button
                    onClick={() => {
                      if (file) {
                        onImport(file);
                      }
                    }}
                    disabled={!file}
                    className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed"
                  >
                    ‚úÖ Importer
                  </button>
                </div>
              </div>
            </div>
          );
        };

        const HomeView = () => (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-6">
            <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full">
              <ConfigBanner />
              
              <div className="text-center mb-8">
                <h1 className="text-4xl font-bold text-gray-800 mb-2">
                  üìä Suivi Formation Excel
                </h1>
                <p className="text-gray-600">GEA S1 - Vid√©os Filim</p>
                <p className="text-sm text-gray-500 mt-2">9 s√©ances ‚Ä¢ 3 niveaux avec quiz</p>
                {isConfigured && (
                  <div className="mt-3 flex items-center justify-center gap-2">
                    <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                      ‚úÖ Synchronisation Google Sheets active
                    </span>
                  </div>
                )}
              </div>

              {syncStatus && (
                <div className="mb-4 text-center text-sm font-medium">
                  {syncStatus}
                </div>
              )}

              <div className="space-y-4">
                <button
                  onClick={() => setCurrentView('student-select')}
                  className="w-full py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-lg font-semibold flex items-center justify-center gap-2"
                  disabled={loading}
                >
                  üë®‚Äçüéì Je suis √©tudiant
                </button>

                <button
                  onClick={() => setCurrentView('teacher')}
                  className="w-full py-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-lg font-semibold flex items-center justify-center gap-2"
                  disabled={loading}
                >
                  üë©‚Äçüè´ Mode Enseignant
                </button>

                {isConfigured && (
                  <button
                    onClick={loadAllProgress}
                    className="w-full py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-base font-semibold flex items-center justify-center gap-2"
                    disabled={loading}
                  >
                    {loading ? '‚è≥ Chargement...' : 'üîÑ Recharger les donn√©es'}
                  </button>
                )}
              </div>

              <div className="mt-8 text-center text-sm text-gray-500">
                <p>{students.length} √©tudiants ‚Ä¢ 47 vid√©os ‚Ä¢ Quiz interactifs</p>
                {isConfigured && <p className="mt-1">üîó Synchronis√© avec Google Sheets</p>}
              </div>
            </div>
          </div>
        );

        const StudentSelectView = () => {
          const [searchTerm, setSearchTerm] = useState('');
          const [filterGroup, setFilterGroup] = useState('Tous');

          const filteredStudents = students.filter(s => {
            const matchName = s.nom.toLowerCase().includes(searchTerm.toLowerCase());
            const matchGroup = filterGroup === 'Tous' || s.groupe === filterGroup;
            return matchName && matchGroup;
          });

          return (
            <div className="min-h-screen bg-gray-50 p-6">
              <div className="max-w-4xl mx-auto">
                <ConfigBanner />
                
                <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                  <div className="flex justify-between items-center mb-6">
                    <h1 className="text-2xl font-bold text-gray-800">
                      S√©lectionnez votre nom
                    </h1>
                    <button
                      onClick={() => setCurrentView('home')}
                      className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                    >
                      ‚Üê Retour
                    </button>
                  </div>

                  {syncStatus && (
                    <div className="mb-4 text-center text-sm font-medium">
                      {syncStatus}
                    </div>
                  )}

                  <div className="space-y-4 mb-6">
                    <input
                      type="text"
                      placeholder="üîç Rechercher votre nom..."
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />

                    <div className="flex gap-2">
                      {['Tous', 'TD1', 'TD2'].map(groupe => (
                        <button
                          key={groupe}
                          onClick={() => setFilterGroup(groupe)}
                          className={`px-4 py-2 rounded-lg font-medium ${
                            filterGroup === groupe
                              ? 'bg-blue-600 text-white'
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          {groupe}
                        </button>
                      ))}
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto">
                    {filteredStudents.map(student => (
                      <button
                        key={student.id}
                        onClick={() => {
                          setSelectedStudent(student.nom);
                          setCurrentView('student');
                        }}
                        className="p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-left transition-colors border border-blue-200"
                      >
                        <div className="font-semibold text-gray-800">{student.nom}</div>
                        <div className="text-sm text-gray-600">{student.groupe}</div>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const StudentView = ({ studentName, onLogout }) => {
          const studentProgress = getStudentProgress(studentName);
          const progressPercent = calculateProgress(studentProgress);

          const VideoRow = ({ video, niveau, studentProgress }) => {
            const [showScoreInput, setShowScoreInput] = useState(false);
            const [scoreValue, setScoreValue] = useState('');
            const currentScore = studentProgress[niveau]?.quizScores?.[video.id];

            const handleScoreSave = () => {
              if (scoreValue) {
                updateQuizScore(studentName, niveau, video.id, scoreValue);
                setShowScoreInput(false);
                setScoreValue('');
              }
            };

            return (
              <div className="flex items-center gap-3 p-3 bg-gray-50 rounded">
                <input
                  type="checkbox"
                  checked={studentProgress[niveau]?.videos?.[video.id] || false}
                  onChange={(e) => updateProgress(studentName, niveau, 'videos', video.id, e.target.checked)}
                  className="w-5 h-5 text-blue-600"
                />
                <div className="flex-1">
                  <a
                    href={video.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-blue-600 hover:underline"
                  >
                    {video.title}
                  </a>
                </div>
                <div className="flex items-center gap-2">
                  {video.quiz && (
                    <a
                      href={`${video.quiz}?nom=${encodeURIComponent(studentName)}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="px-3 py-1 bg-purple-500 text-white rounded text-sm hover:bg-purple-600"
                      title="Faire le quiz pour valider vos connaissances"
                    >
                      üéØ Quiz
                    </a>
                  )}
                  {currentScore ? (
                    <div className="flex items-center gap-2">
                      <span className="text-sm font-semibold text-green-600">Score: {currentScore}</span>
                      <button
                        onClick={() => setShowScoreInput(true)}
                        className="text-xs text-blue-600 hover:underline"
                      >
                        modifier
                      </button>
                    </div>
                  ) : (
                    showScoreInput ? (
                      <div className="flex items-center gap-2">
                        <input
                          type="text"
                          placeholder="ex: 5/6"
                          value={scoreValue}
                          onChange={(e) => setScoreValue(e.target.value)}
                          className="w-16 px-2 py-1 text-sm border rounded"
                        />
                        <button
                          onClick={handleScoreSave}
                          className="px-2 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600"
                        >
                          ‚úì
                        </button>
                        <button
                          onClick={() => {
                            setShowScoreInput(false);
                            setScoreValue('');
                          }}
                          className="px-2 py-1 bg-gray-400 text-white text-xs rounded hover:bg-gray-500"
                        >
                          ‚úó
                        </button>
                      </div>
                    ) : (
                      <button
                        onClick={() => setShowScoreInput(true)}
                        className="px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded hover:bg-gray-300"
                      >
                        + Score
                      </button>
                    )
                  )}
                </div>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-gray-50 p-6">
              <div className="max-w-6xl mx-auto">
                <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                  <div className="flex justify-between items-center">
                    <div>
                      <h1 className="text-2xl font-bold text-gray-800">
                        üëã Bonjour {studentName}
                      </h1>
                      <p className="text-gray-600">Suivi de votre progression Excel - Filim</p>
                      {isConfigured && (
                        <p className="text-sm text-green-600 mt-1">üîó Synchronis√© avec Google Sheets</p>
                      )}
                    </div>
                    <button
                      onClick={onLogout}
                      className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                    >
                      ‚Üê Retour
                    </button>
                  </div>

                  {syncStatus && (
                    <div className="mt-3 text-center text-sm font-medium">
                      {syncStatus}
                    </div>
                  )}

                  <div className="mt-6">
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-sm font-medium text-gray-700">Progression globale</span>
                      <span className="text-sm font-bold text-blue-600">{progressPercent}%</span>
                    </div>
                    <div className="w-full bg-gray-200 rounded-full h-3">
                      <div
                        className="bg-blue-600 h-3 rounded-full transition-all duration-500"
                        style={{ width: `${progressPercent}%` }}
                      ></div>
                    </div>
                  </div>
                </div>

                {['niveau1', 'niveau2'].map(niveauKey => {
                  const niveau = courseStructure[niveauKey];
                  return (
                    <div key={niveauKey} className="bg-white rounded-lg shadow-md p-6 mb-6">
                      <h2 className="text-xl font-bold text-gray-800 mb-4">{niveau.title}</h2>

                      <div className="mb-4">
                        <h3 className="font-semibold text-gray-700 mb-2 flex items-center gap-2">
                          üì∫ Vid√©os de cours
                          <a
                            href={niveau.playlistCours}
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-sm text-blue-600 hover:underline"
                          >
                            (Voir la playlist ‚Üí)
                          </a>
                        </h3>
                        <div className="space-y-2">
                          {niveau.videos.map(video => (
                            <VideoRow key={video.id} video={video} niveau={niveauKey} studentProgress={studentProgress} />
                          ))}
                        </div>
                      </div>

                      <div>
                        <h3 className="font-semibold text-gray-700 mb-2 flex items-center gap-2">
                          ‚úèÔ∏è Exercices pratiques
                          <a
                            href={niveau.playlistExercices}
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-sm text-blue-600 hover:underline"
                          >
                            (Voir la playlist ‚Üí)
                          </a>
                        </h3>
                        <div className="space-y-2">
                          {niveau.exercices.map(exercice => (
                            <div key={exercice.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded">
                              <input
                                type="checkbox"
                                checked={studentProgress[niveauKey]?.exercices?.[exercice.id] || false}
                                onChange={(e) => updateProgress(studentName, niveauKey, 'exercices', exercice.id, e.target.checked)}
                                className="w-5 h-5 text-green-600"
                              />
                              <a
                                href={exercice.url}
                                target="_blank"
                                rel="noopener noreferrer"
                                className="text-gray-700 hover:text-blue-600"
                              >
                                {exercice.title}
                              </a>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  );
                })}

                <div className="bg-white rounded-lg shadow-md p-6 mb-6 border-4 border-yellow-400">
                  <div className="flex items-center gap-3 mb-4">
                    <h2 className="text-xl font-bold text-gray-800">{courseStructure.niveau3.title}</h2>
                    <span className="px-3 py-1 bg-yellow-400 text-yellow-900 rounded-full text-sm font-bold">
                      ‚≠ê BONUS
                    </span>
                  </div>

                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                    <p className="text-sm text-yellow-800">
                      üì¢ <strong>Contenu optionnel :</strong> Ce niveau est pour ceux qui veulent aller plus loin ! 
                      Compl√©tez d'abord les niveaux 1 et 2.
                    </p>
                  </div>

                  <div className="mb-4">
                    <h3 className="font-semibold text-gray-700 mb-2 flex items-center gap-2">
                      üì∫ Vid√©os de cours
                      <a
                        href={courseStructure.niveau3.playlistCours}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-sm text-blue-600 hover:underline"
                      >
                        (Voir la playlist ‚Üí)
                      </a>
                    </h3>
                    <div className="space-y-2">
                      {courseStructure.niveau3.videos.map(video => (
                        <VideoRow key={video.id} video={video} niveau="niveau3" studentProgress={studentProgress} />
                      ))}
                    </div>
                  </div>

                  <div>
                    <h3 className="font-semibold text-gray-700 mb-2 flex items-center gap-2">
                      ‚úèÔ∏è Exercices pratiques
                      <a
                        href={courseStructure.niveau3.playlistExercices}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-sm text-blue-600 hover:underline"
                      >
                        (Voir la playlist ‚Üí)
                      </a>
                    </h3>
                    <div className="space-y-2">
                      {courseStructure.niveau3.exercices.map(exercice => (
                        <div key={exercice.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded">
                          <input
                            type="checkbox"
                            checked={studentProgress.niveau3?.exercices?.[exercice.id] || false}
                            onChange={(e) => updateProgress(studentName, 'niveau3', 'exercices', exercice.id, e.target.checked)}
                            className="w-5 h-5 text-green-600"
                          />
                          <span className="text-gray-700">{exercice.title}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-md p-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">üìÖ Planning des 9 s√©ances</h2>
                  <div className="space-y-2">
                    {seancePlanning.map(seance => (
                      <div
                        key={seance.numero}
                        className={`p-3 rounded-lg ${
                          seance.evaluation
                            ? 'bg-red-50 border border-red-200'
                            : 'bg-gray-50'
                        }`}
                      >
                        <div className="flex justify-between items-center">
                          <span className="font-semibold">
                            S√©ance {seance.numero} {seance.evaluation ? 'üéØ' : ''}
                          </span>
                          <span className="text-sm text-gray-600">{seance.duree}</span>
                        </div>
                        <div className="text-sm text-gray-700 mt-1">{seance.contenu}</div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const TeacherView = ({ onLogout }) => {
          const [filterGroup, setFilterGroup] = useState('Tous');
          const [selectedStudent, setSelectedStudent] = useState(null);

          if (selectedStudent) {
            const studentProgress = getStudentProgress(selectedStudent);
            const progressPercent = calculateProgress(studentProgress);

            return (
              <div className="min-h-screen bg-gray-50 p-6">
                <div className="max-w-6xl mx-auto">
                  <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                    <div className="flex justify-between items-center">
                      <div>
                        <h1 className="text-2xl font-bold text-gray-800">
                          üìä D√©tail : {selectedStudent}
                        </h1>
                      </div>
                      <button
                        onClick={() => setSelectedStudent(null)}
                        className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                      >
                        ‚Üê Retour liste
                      </button>
                    </div>

                    <div className="mt-6">
                      <div className="flex items-center justify-between mb-2">
                        <span className="text-sm font-medium text-gray-700">Progression</span>
                        <span className="text-sm font-bold text-blue-600">{progressPercent}%</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-3">
                        <div
                          className="bg-blue-600 h-3 rounded-full"
                          style={{ width: `${progressPercent}%` }}
                        ></div>
                      </div>
                    </div>
                  </div>

                  {['niveau1', 'niveau2', 'niveau3'].map(niveauKey => {
                    const niveau = courseStructure[niveauKey];
                    const quizScores = studentProgress[niveauKey]?.quizScores || {};
                    
                    return (
                      <div key={niveauKey} className="bg-white rounded-lg shadow-md p-6 mb-6">
                        <h2 className="text-xl font-bold text-gray-800 mb-4">
                          {niveau.title}
                          {niveau.bonus && (
                            <span className="ml-2 px-2 py-1 bg-yellow-400 text-yellow-900 rounded text-sm">
                              BONUS
                            </span>
                          )}
                        </h2>

                        <div className="mb-4">
                          <h3 className="font-semibold text-gray-700 mb-2">Vid√©os et Quiz</h3>
                          <div className="space-y-2">
                            {niveau.videos.map(video => (
                              <div
                                key={video.id}
                                className="flex items-center justify-between p-2 rounded text-sm bg-gray-50"
                              >
                                <div className="flex items-center gap-2">
                                  <span>
                                    {studentProgress[niveauKey]?.videos?.[video.id] ? '‚úÖ' : '‚¨ú'}
                                  </span>
                                  <span className="text-gray-700">{video.title}</span>
                                </div>
                                {quizScores[video.id] && (
                                  <span className="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-semibold">
                                    Quiz: {quizScores[video.id]}
                                  </span>
                                )}
                              </div>
                            ))}
                          </div>
                        </div>

                        <div>
                          <h3 className="font-semibold text-gray-700 mb-2">Exercices</h3>
                          <div className="grid grid-cols-2 gap-2">
                            {niveau.exercices.map(exercice => (
                              <div
                                key={exercice.id}
                                className={`p-2 rounded text-sm ${
                                  studentProgress[niveauKey]?.exercices?.[exercice.id]
                                    ? 'bg-green-100 text-green-800'
                                    : 'bg-gray-100 text-gray-600'
                                }`}
                              >
                                {studentProgress[niveauKey]?.exercices?.[exercice.id] ? '‚úÖ' : '‚¨ú'} {exercice.title}
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            );
          }

          const studentsWithProgress = students.map(student => ({
            ...student,
            progress: calculateProgress(getStudentProgress(student.nom))
          }));

          const filteredStudents = studentsWithProgress.filter(s =>
            filterGroup === 'Tous' || s.groupe === filterGroup
          );

          const stats = {
            moyenne: Math.round(
              filteredStudents.reduce((sum, s) => sum + s.progress, 0) / filteredStudents.length
            ),
            avances: filteredStudents.filter(s => s.progress >= 70).length,
            enRetard: filteredStudents.filter(s => s.progress < 30).length
          };

          return (
            <div className="min-h-screen bg-gray-50 p-6">
              <div className="max-w-7xl mx-auto">
                <ConfigBanner />
                
                <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                  <div className="flex justify-between items-center mb-4">
                    <div>
                      <h1 className="text-3xl font-bold text-gray-800">
                        üë©‚Äçüè´ Vue Enseignant
                      </h1>
                      <p className="text-gray-600">Suivi de progression des {students.length} √©tudiants</p>
                      {isConfigured && (
                        <p className="text-sm text-green-600 mt-1">üîó Synchronis√© avec Google Sheets</p>
                      )}
                    </div>
                    <div className="flex gap-3">
                      <button
                        onClick={() => setShowImportModal(true)}
                        className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2"
                      >
                        üì• Importer CSV
                      </button>
                      {isConfigured && (
                        <button
                          onClick={loadAllProgress}
                          className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2"
                          disabled={loading}
                        >
                          {loading ? '‚è≥ Chargement...' : 'üîÑ Actualiser'}
                        </button>
                      )}
                      <button
                        onClick={onLogout}
                        className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                      >
                        ‚Üê Retour
                      </button>
                    </div>
                  </div>

                  {syncStatus && (
                    <div className="mb-4 text-center text-sm font-medium">
                      {syncStatus}
                    </div>
                  )}

                  <div className="flex gap-2 mb-4">
                    {['Tous', 'TD1', 'TD2'].map(groupe => (
                      <button
                        key={groupe}
                        onClick={() => setFilterGroup(groupe)}
                        className={`px-4 py-2 rounded-lg font-medium ${
                          filterGroup === groupe
                            ? 'bg-purple-600 text-white'
                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                        }`}
                      >
                        {groupe}
                      </button>
                    ))}
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div className="bg-blue-50 p-4 rounded-lg">
                      <div className="text-sm text-gray-600">Progression moyenne</div>
                      <div className="text-3xl font-bold text-blue-600">{stats.moyenne}%</div>
                    </div>
                    <div className="bg-green-50 p-4 rounded-lg">
                      <div className="text-sm text-gray-600">√âtudiants avanc√©s</div>
                      <div className="text-3xl font-bold text-green-600">{stats.avances}</div>
                    </div>
                    <div className="bg-red-50 p-4 rounded-lg">
                      <div className="text-sm text-gray-600">En difficult√©</div>
                      <div className="text-3xl font-bold text-red-600">{stats.enRetard}</div>
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-md p-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">
                    Liste des √©tudiants ({filteredStudents.length})
                  </h2>
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-gray-100">
                        <tr>
                          <th className="px-4 py-3 text-left text-sm font-semibold text-gray-700">Nom</th>
                          <th className="px-4 py-3 text-left text-sm font-semibold text-gray-700">Groupe</th>
                          <th className="px-4 py-3 text-left text-sm font-semibold text-gray-700">Progression</th>
                          <th className="px-4 py-3 text-left text-sm font-semibold text-gray-700">Statut</th>
                          <th className="px-4 py-3 text-left text-sm font-semibold text-gray-700">Action</th>
                        </tr>
                      </thead>
                      <tbody>
                        {filteredStudents
                          .sort((a, b) => a.progress - b.progress)
                          .map(student => (
                            <tr key={student.id} className="border-t hover:bg-gray-50">
                              <td className="px-4 py-3 text-sm text-gray-800">{student.nom}</td>
                              <td className="px-4 py-3 text-sm text-gray-600">{student.groupe}</td>
                              <td className="px-4 py-3">
                                <div className="flex items-center gap-2">
                                  <div className="w-24 bg-gray-200 rounded-full h-2">
                                    <div
                                      className={`h-2 rounded-full ${
                                        student.progress >= 70 ? 'bg-green-500' :
                                        student.progress >= 30 ? 'bg-yellow-500' : 'bg-red-500'
                                      }`}
                                      style={{ width: `${student.progress}%` }}
                                    ></div>
                                  </div>
                                  <span className="text-sm font-medium">{student.progress}%</span>
                                </div>
                              </td>
                              <td className="px-4 py-3">
                                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${
                                  student.progress >= 70 ? 'bg-green-100 text-green-800' :
                                  student.progress >= 30 ? 'bg-yellow-100 text-yellow-800' :
                                  'bg-red-100 text-red-800'
                                }`}>
                                  {student.progress >= 70 ? '‚úÖ Avanc√©' :
                                   student.progress >= 30 ? '‚è≥ En cours' : '‚ö†Ô∏è Retard'}
                                </span>
                              </td>
                              <td className="px-4 py-3">
                                <button
                                  onClick={() => setSelectedStudent(student.nom)}
                                  className="text-blue-600 hover:text-blue-800 text-sm font-medium"
                                >
                                  Voir d√©tail ‚Üí
                                </button>
                              </td>
                            </tr>
                          ))}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        return (
          <>
            {showImportModal && (
              <ImportModal
                onClose={() => setShowImportModal(false)}
                onImport={handleImportCSV}
              />
            )}
            {currentView === 'home' && <HomeView />}
            {currentView === 'student-select' && <StudentSelectView />}
            {currentView === 'student' && (
              <StudentView
                studentName={selectedStudent}
                onLogout={() => {
                  setSelectedStudent(null);
                  setCurrentView('home');
                }}
              />
            )}
            {currentView === 'teacher' && (
              <TeacherView
                onLogout={() => setCurrentView('home')}
              />
            )}
          </>
        );
      };

      ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>